<Window
    x:Class="MediFiler_V2.Code.MainWindow"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:local="using:MediFiler_V2"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    mc:Ignorable="d">


    <Grid x:Name="MainContent" AllowDrop="True" Drop="Window_OnDrop" DragOver="Window_OnDragOver">
        <Grid.RowDefinitions>
            <RowDefinition Height="32"/>
            <RowDefinition/>
        </Grid.RowDefinitions>

        <!--Title bar-->
        <Grid x:Name="AppTitleBar" Height="32" Background="#000000" VerticalAlignment="Top" Grid.Row="0">
            
            <Image Source="../Assets/Icon.ico"
                   HorizontalAlignment="Left" 
                   Width="16" Height="16" Margin="8,0"/>

            <TextBlock x:Name="AppTitleTextBlock" Text="MediFiler v2"
                       TextWrapping="NoWrap"
                       Style="{StaticResource CaptionTextBlockStyle}" 
                       VerticalAlignment="Center"
                       Margin="28,0,0,0"/>
        </Grid>

        <!--Left navigation panel-->
        <NavigationView Grid.Row="1" Grid.Column="0"
                        IsBackButtonVisible="Collapsed"
                        IsSettingsVisible="True"
                        PaneDisplayMode="LeftCompact">
            
            <!--Default image view-->
            <Grid Background="Black" Name="FileHolder" PointerWheelChanged="MouseWheelScrollHandler" SizeChanged="ImageViewer_SizeChanged">
                <Image
                    Name="FileViewer"
                    Stretch="Uniform"
                    Source="../Assets/Icon.ico"/>
                <StackPanel Orientation="Horizontal" HorizontalAlignment="Center" VerticalAlignment="Center">

                </StackPanel>
            </Grid>
            
        </NavigationView>

        <!-- Preview bottom bar -->
        <Grid x:Name="PreviewBar" Height="150" Width="Auto" VerticalAlignment="Bottom"
            Row="1" Opacity="0.3" 
              PointerEntered="PreviewEnter" PointerExited="PreviewLeave">

            <Grid.Background>
                <LinearGradientBrush EndPoint="0.5,1" StartPoint="0.5,0" Opacity="0.75">
                    <GradientStop Color="#7F000000" Offset="1"/>
                    <GradientStop Color="#00000000"/>
                </LinearGradientBrush>
            </Grid.Background>

            <Grid.RenderTransform>
                <TranslateTransform x:Name="MoveHelper" Y="135"/>
            </Grid.RenderTransform>

            <StackPanel Name="PreviewImageContainer" Orientation="Horizontal" HorizontalAlignment="Center">
                <Border Width="150">
                    <Image VerticalAlignment="Center" Stretch="UniformToFill" HorizontalAlignment="Center" Source="../Assets/TestAssets/manga.jpg"/>
                </Border>
                <Border Width="150">
                    <Image VerticalAlignment="Center" Stretch="UniformToFill" HorizontalAlignment="Center" Source="../Assets/TestAssets/default.png"/>
                </Border>
                <Border Width="150">
                    <Image VerticalAlignment="Center" Stretch="UniformToFill" HorizontalAlignment="Center" Source="../Assets/TestAssets/manga.jpg"/>
                </Border>

            </StackPanel>

            <Grid.Resources>
                <Storyboard x:Name="ShowPreviews">
                    <DoubleAnimation Storyboard.TargetName="MoveHelper" Storyboard.TargetProperty="Y" To="0" Duration="0:0:0.1"/>
                    <DoubleAnimation Storyboard.TargetName="PreviewBar" Storyboard.TargetProperty="Grid.Opacity" To="1" Duration="0:0:0.1" />
                </Storyboard>
                <Storyboard x:Name="HidePreviews">
                    <DoubleAnimation Storyboard.TargetName="MoveHelper" Storyboard.TargetProperty="Y" To="135" Duration="0:0:0.1"/>
                    <DoubleAnimation Storyboard.TargetName="PreviewBar" Storyboard.TargetProperty="Grid.Opacity" To="0.3" Duration="0:0:0.1" />
                </Storyboard>
            </Grid.Resources>
                
        </Grid>

        <!--Sorting panel-->
        <Grid Grid.Row="1">
            <TreeView 
                Name="FileTreeView"
                Background="Transparent" 
                HorizontalAlignment="Left" 
                Width="500" 
                VerticalAlignment="Stretch"
                CanDrag="False"
                CanDragItems="False"
                CanReorderItems="False"
                SelectionMode="None">
                <TreeView.Resources>
                    <local:IndentConverter x:Key="IndentConverter"></local:IndentConverter>
                </TreeView.Resources>
                <TreeView.ItemTemplate>
                    <DataTemplate x:DataType="local:FileNode">
                        <TreeViewItem 
                            Tapped="FolderListLeftClick"
                            RightTapped="FolderListRightClick"
                            CanDrag="False">
                            <TextBlock
                                Margin="{Binding Depth, Converter={StaticResource IndentConverter}}"
                                Text="{Binding Name}">

                            </TextBlock>
                        </TreeViewItem>
                    </DataTemplate>
                </TreeView.ItemTemplate>
            </TreeView>
        </Grid>
    </Grid>
</Window>
